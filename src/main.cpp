#include "stdlib.h"
#include "lidar_delat_2a.h"
#include "laser_lidar_g4.h"

const uint8_t buf[90] = { 0xAA,0x55,0x00,0x28,0x11,0x1F,0xBD,0x24,0xDA,0x42,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xE5,0x04,0xE5,0x04,0xE1,0x04,0xE1,0x04,0xDD,0x04,0xDD,0x04,0xDD,0x04,0xE1,0x04,0xE1,0x04,0xE1,0x04,0xE0,0x04,0xE0,0x04,0xE0,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00 };
void text_crc(uint8_t*buf) {
	uint8_t sampleNum = buf[3];
	uint16_t crcXor = buf[8] | (buf[9] << 8);
	uint16_t FSA = buf[4] | (buf[5] << 8);
	uint16_t LSA = buf[6] | (buf[7] << 8);
	uint8_t CT = buf[2];
	uint16_t PH = buf[0] | (buf[1] << 8);

	crcXor ^= PH;
	crcXor ^= FSA;
	crcXor ^= LSA;
	crcXor ^= CT | (sampleNum << 8);
	for (int i = 0; i < sampleNum; ++i) {
		crcXor ^= (buf[10 + i * 2] | (buf[11 + i * 2] << 8));
	}
	printf("crcXor:0x%2x 0x%x 0x%x\r\n", crcXor, buf[8], buf[9]);
	if (crcXor != 0) {
		printf("crcXor failed:0x%x\r\n", crcXor);
	}
}
int main(int argc ,char* argv[]) {
	//lidar_delat_get_data();
	Get_LiDAR_Data_G4();

	//system("pause");
	return 0;
}